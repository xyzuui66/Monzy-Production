<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Create Your City | Classic Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        :root {
            --pixel-border: 4px solid #000;
            --ui-bg: #c0c0c0;
            --ui-shadow: inset -2px -2px #808080, inset 2px 2px #ffffff;
        }

        body { 
            font-family: 'VT323', monospace; 
            background: #1a1a1a; 
            margin: 0; 
            overflow: hidden; 
            image-rendering: pixelated;
        }

        /* TheoTown Classic UI Style */
        .classic-ui {
            background: var(--ui-bg);
            border: var(--pixel-border);
            box-shadow: var(--ui-shadow);
            color: #000;
        }

        .btn-tool {
            width: 44px;
            height: 44px;
            background: #d0d0d0;
            border: 2px solid #808080;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            image-rendering: pixelated;
        }

        .btn-tool.active {
            background: #3b82f6;
            border-color: #ffffff;
            box-shadow: inset 2px 2px #000000;
        }

        canvas { background-color: #4a7a4a; cursor: crosshair; }

        #remote-screen {
            display: none; position: fixed; inset: 0; background: #000; z-index: 10000;
            flex-direction: column; align-items: center; justify-content: center;
            color: #ff0000; font-size: 2rem;
        }
    </style>
</head>
<body>

    <div id="remote-screen">
        <p class="animate-pulse">ACCESS DENIED</p>
        <span class="text-white text-sm mt-4 font-sans uppercase tracking-[5px]">Monzy Production Central Control</span>
    </div>

    <div class="fixed top-2 left-2 right-2 flex justify-between items-start pointer-events-none z-50">
        <div class="classic-ui px-4 py-1 pointer-events-auto flex gap-4 text-xl">
            <span class="text-green-800">ï¼„<span id="money">15000</span></span>
            <span class="text-blue-800">ðŸ‘¤<span id="pop">0</span></span>
        </div>
        <div class="classic-ui px-3 py-1 text-sm uppercase tracking-tighter pointer-events-auto">
            Create Your City <span class="ml-2 text-zinc-500">v1.2</span>
        </div>
    </div>

    <canvas id="world"></canvas>

    <div class="fixed right-4 top-1/2 -translate-y-1/2 flex flex-col gap-1 z-50">
        <button onclick="setTool('res')" id="btn-res" title="Residential" class="btn-tool"><i class="fas fa-home"></i></button>
        <button onclick="setTool('ind')" id="btn-ind" title="Industrial" class="btn-tool"><i class="fas fa-industry"></i></button>
        <button onclick="setTool('park')" id="btn-park" title="Park" class="btn-tool"><i class="fas fa-tree"></i></button>
        <button onclick="setTool('road')" id="btn-road" title="Road" class="btn-tool"><i class="fas fa-road"></i></button>
        <div class="h-2"></div>
        <button onclick="setTool('delete')" id="btn-delete" title="Bulldozer" class="btn-tool"><i class="fas fa-hammer text-red-600"></i></button>
    </div>

    <div class="fixed bottom-2 left-2 classic-ui flex gap-2 px-2 py-1 items-end h-12">
        <div id="demand-r" class="w-2 bg-green-500" style="height: 80%"></div>
        <div id="demand-i" class="w-2 bg-yellow-500" style="height: 40%"></div>
        <span class="text-[10px] font-bold ml-1 uppercase">RCI</span>
    </div>

    <script>
        // --- MONZY REAL-TIME SYNC ---
        const firebaseConfig = {
            apiKey: "AIzaSyBeGnAjNVmoB-uYGWadpFkEyxlPpuTmz2o",
            authDomain: "ceziroom.firebaseapp.com",
            databaseURL: "https://ceziroom-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "ceziroom",
            storageBucket: "ceziroom.firebasestorage.app",
            messagingSenderId: "771662623358",
            appId: "1:771662623358:web:de5b7635f3ff27f19fde2f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const projectName = "CreateYourCity";

        function syncWithMonzy() {
            const ref = db.ref(`monzy_production/active_webs/${projectName}`);
            ref.update({ name: "Create Your City", status: "Online", lastSeen: new Date().toLocaleTimeString() });
            ref.onDisconnect().update({ status: "Offline" });

            db.ref(`monzy_production/remote_control/${projectName}`).on('value', snap => {
                document.getElementById('remote-screen').style.display = (snap.val() === "SHUTDOWN") ? "flex" : "none";
            });
        }

        // --- GAME ENGINE ---
        const canvas = document.getElementById('world');
        const ctx = canvas.getContext('2d');
        const gridSize = 32;
        let money = 15000;
        let pop = 0;
        let buildings = [];
        let currentTool = null;

        const config = {
            res: { color: '#4ade80', cost: 100, pop: 15, income: 0, icon: 'ðŸ ' },
            ind: { color: '#facc15', cost: 300, pop: 0, income: 40, icon: 'ðŸ­' },
            park: { color: '#22c55e', cost: 50, pop: 2, income: -5, icon: 'ðŸŒ³' },
            road: { color: '#444444', cost: 10, pop: 0, income: 0, icon: '' }
        };

        function init() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            draw();
        }

        function setTool(t) {
            currentTool = t;
            document.querySelectorAll('.btn-tool').forEach(b => b.classList.remove('active'));
            if(t) document.getElementById('btn-'+t).classList.add('active');
        }

        canvas.addEventListener('mousedown', (e) => {
            const x = Math.floor(e.clientX / gridSize) * gridSize;
            const y = Math.floor(e.clientY / gridSize) * gridSize;

            if(currentTool === 'delete') {
                const i = buildings.findIndex(b => b.x === x && b.y === y);
                if(i > -1) buildings.splice(i, 1);
            } else if(currentTool && config[currentTool]) {
                if(money >= config[currentTool].cost && !buildings.some(b => b.x === x && b.y === y)) {
                    money -= config[currentTool].cost;
                    buildings.push({ x, y, type: currentTool });
                }
            }
            updateStats();
            draw();
        });

        function updateStats() {
            pop = buildings.reduce((a, b) => a + config[b.type].pop, 0);
            document.getElementById('money').innerText = Math.floor(money);
            document.getElementById('pop').innerText = pop;
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Grid Lines (Minimalist)
            ctx.strokeStyle = "rgba(255,255,255,0.05)";
            for(let i=0; i<canvas.width; i+=gridSize) {
                ctx.beginPath(); ctx.moveTo(i,0); ctx.lineTo(i, canvas.height); ctx.stroke();
            }
            for(let i=0; i<canvas.height; i+=gridSize) {
                ctx.beginPath(); ctx.moveTo(0,i); ctx.lineTo(canvas.width, i); ctx.stroke();
            }

            buildings.forEach(b => {
                ctx.fillStyle = config[b.type].color;
                ctx.fillRect(b.x + 1, b.y + 1, gridSize - 2, gridSize - 2);
                
                // Draw Icon
                if(config[b.type].icon) {
                    ctx.fillStyle = "rgba(0,0,0,0.5)";
                    ctx.font = "16px sans-serif";
                    ctx.textAlign = "center";
                    ctx.fillText(config[b.type].icon, b.x + gridSize/2, b.y + gridSize/2 + 6);
                }
            });
        }

        // TheoTown Style Simulation Loop
        setInterval(() => {
            buildings.forEach(b => {
                money += (config[b.type].income / 10);
            });
            updateStats();
            
            // Demand Logic
            const rDemand = Math.max(10, 100 - (pop / 50));
            document.getElementById('demand-r').style.height = rDemand + '%';
        }, 1000);

        window.onresize = init;
        init();
        syncWithMonzy();
    </script>
</body>
</html>

